!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports["pgn-parser"]=n():t["pgn-parser"]=n()}(global,(function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="/lib/",e(e.s=2)}([function(t,n,e){const r=e(3);t.exports={SyntaxError:r.SyntaxError,parse:function(t,n){if(!n||"pgn"===n.startRule)return r.parse(t.trim());let e=r.parse(t,n);if(n&&"games"===n.startRule){if(!Array.isArray(e))return e;if(0===e.length)return e;let t=e.pop();return(Object.keys(t.tags).length>0||t.moves.length>0)&&e.push(t),e}return e}}},function(t,n,e){var r,o=function(t){var n="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",e=["1-0","0-1","1/2-1/2","*"],r={b:[16,32,17,15],w:[-16,-32,-17,-15]},o={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},i=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],u=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],a={p:0,n:1,b:2,r:3,q:4,k:5},s={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},l={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},c={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},f={w:[{square:c.a1,flag:l.QSIDE_CASTLE},{square:c.h1,flag:l.KSIDE_CASTLE}],b:[{square:c.a8,flag:l.QSIDE_CASTLE},{square:c.h8,flag:l.KSIDE_CASTLE}]},v=new Array(128),p={w:-1,b:-1},h="w",g={w:0,b:0},m=-1,d=0,b=1,A=[],E={};function y(t){void 0===t&&(t=!1),v=new Array(128),p={w:-1,b:-1},h="w",g={w:0,b:0},m=-1,d=0,b=1,A=[],t||(E={}),w(k())}function C(){S(n)}function S(t,n){void 0===n&&(n=!1);var e=t.split(/\s+/),r=e[0],o=0;if(!N(t).valid)return!1;y(n);for(var i=0;i<r.length;i++){var u=r.charAt(i);if("/"===u)o+=8;else if(-1!=="0123456789".indexOf(u))o+=parseInt(u,10);else{var a=u<"a"?"w":"b";x({type:u.toLowerCase(),color:a},K(o)),o++}}return h=e[1],e[2].indexOf("K")>-1&&(g.w|=l.KSIDE_CASTLE),e[2].indexOf("Q")>-1&&(g.w|=l.QSIDE_CASTLE),e[2].indexOf("k")>-1&&(g.b|=l.KSIDE_CASTLE),e[2].indexOf("q")>-1&&(g.b|=l.QSIDE_CASTLE),m="-"===e[3]?-1:c[e[3]],d=parseInt(e[4],10),b=parseInt(e[5],10),w(k()),!0}function N(t){var n="No errors.",e="FEN string must contain six space-delimited fields.",r="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",i="4th field (en-passant square) is invalid.",u="3rd field (castling availability) is invalid.",a="2nd field (side to move) is invalid.",s="1st field (piece positions) does not contain 8 '/'-delimited rows.",l="1st field (piece positions) is invalid [consecutive numbers].",c="1st field (piece positions) is invalid [invalid piece].",f="1st field (piece positions) is invalid [row too large].",v="Illegal en-passant square",p=t.split(/\s+/);if(6!==p.length)return{valid:!1,error_number:1,error:e};if(isNaN(p[5])||parseInt(p[5],10)<=0)return{valid:!1,error_number:2,error:r};if(isNaN(p[4])||parseInt(p[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(p[3]))return{valid:!1,error_number:4,error:i};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(p[2]))return{valid:!1,error_number:5,error:u};if(!/^(w|b)$/.test(p[1]))return{valid:!1,error_number:6,error:a};var h=p[0].split("/");if(8!==h.length)return{valid:!1,error_number:7,error:s};for(var g=0;g<h.length;g++){for(var m=0,d=!1,b=0;b<h[g].length;b++)if(isNaN(h[g][b])){if(!/^[prnbqkPRNBQK]$/.test(h[g][b]))return{valid:!1,error_number:9,error:c};m+=1,d=!1}else{if(d)return{valid:!1,error_number:8,error:l};m+=parseInt(h[g][b],10),d=!0}if(8!==m)return{valid:!1,error_number:10,error:f}}return"3"==p[3][1]&&"w"==p[1]||"6"==p[3][1]&&"b"==p[1]?{valid:!1,error_number:11,error:v}:{valid:!0,error_number:0,error:n}}function k(){for(var t=0,n="",e=c.a8;e<=c.h1;e++){if(null==v[e])t++;else{t>0&&(n+=t,t=0);var r=v[e].color,o=v[e].type;n+="w"===r?o.toUpperCase():o.toLowerCase()}e+1&136&&(t>0&&(n+=t),e!==c.h1&&(n+="/"),t=0,e+=8)}var i="";g.w&l.KSIDE_CASTLE&&(i+="K"),g.w&l.QSIDE_CASTLE&&(i+="Q"),g.b&l.KSIDE_CASTLE&&(i+="k"),g.b&l.QSIDE_CASTLE&&(i+="q"),i=i||"-";var u=-1===m?"-":K(m);return[n,h,i,u,d,b].join(" ")}function T(t){for(var n=0;n<t.length;n+=2)"string"==typeof t[n]&&"string"==typeof t[n+1]&&(E[t[n]]=t[n+1]);return E}function w(t){A.length>0||(t!==n?(E.SetUp="1",E.FEN=t):(delete E.SetUp,delete E.FEN))}function _(t){var n=v[c[t]];return n?{type:n.type,color:n.color}:null}function x(t,n){if(!("type"in t)||!("color"in t))return!1;if(-1==="pnbrqkPNBRQK".indexOf(t.type.toLowerCase()))return!1;if(!(n in c))return!1;var e=c[n];return("k"!=t.type||-1==p[t.color]||p[t.color]==e)&&(v[e]={type:t.type,color:t.color},"k"===t.type&&(p[t.color]=e),w(k()),!0)}function O(t,n,e,r,o){var i={color:h,from:n,to:e,flags:r,piece:t[n].type};return o&&(i.flags|=l.PROMOTION,i.promotion=o),t[e]?i.captured=t[e].type:r&l.EP_CAPTURE&&(i.captured="p"),i}function P(t){function n(t,n,e,r,o){if("p"!==t[e].type||0!==q(r)&&7!==q(r))n.push(O(t,e,r,o));else for(var i=["q","r","b","n"],u=0,a=i.length;u<a;u++)n.push(O(t,e,r,o,i[u]))}var e=[],i=h,u=V(i),a={b:1,w:6},s=c.a8,f=c.h1,d=!1,b=void 0===t||!("legal"in t)||t.legal;if(void 0!==t&&"square"in t){if(!(t.square in c))return[];s=f=c[t.square],d=!0}for(var A=s;A<=f;A++)if(136&A)A+=7;else{var E=v[A];if(null!=E&&E.color===i)if("p"===E.type){var y=A+r[i][0];if(null==v[y]){n(v,e,A,y,l.NORMAL);y=A+r[i][1];a[i]===q(A)&&null==v[y]&&n(v,e,A,y,l.BIG_PAWN)}for(C=2;C<4;C++){136&(y=A+r[i][C])||(null!=v[y]&&v[y].color===u?n(v,e,A,y,l.CAPTURE):y===m&&n(v,e,A,m,l.EP_CAPTURE))}}else for(var C=0,S=o[E.type].length;C<S;C++){var N=o[E.type][C];for(y=A;!(136&(y+=N));){if(null!=v[y]){if(v[y].color===i)break;n(v,e,A,y,l.CAPTURE);break}if(n(v,e,A,y,l.NORMAL),"n"===E.type||"k"===E.type)break}}}if(!d||f===p[i]){if(g[i]&l.KSIDE_CASTLE){var k=(T=p[i])+2;null!=v[T+1]||null!=v[k]||B(u,p[i])||B(u,T+1)||B(u,k)||n(v,e,p[i],k,l.KSIDE_CASTLE)}if(g[i]&l.QSIDE_CASTLE){var T;k=(T=p[i])-2;null!=v[T-1]||null!=v[T-2]||null!=v[T-3]||B(u,p[i])||B(u,T-1)||B(u,k)||n(v,e,p[i],k,l.QSIDE_CASTLE)}}if(!b)return e;var w=[];for(A=0,S=e.length;A<S;A++)M(e[A]),R(i)||w.push(e[A]),F();return w}function U(t,n){var e="";if(t.flags&l.KSIDE_CASTLE)e="O-O";else if(t.flags&l.QSIDE_CASTLE)e="O-O-O";else{var r=function(t,n){for(var e=P({legal:!n}),r=t.from,o=t.to,i=t.piece,u=0,a=0,s=0,l=0,c=e.length;l<c;l++){var f=e[l].from,v=e[l].to,p=e[l].piece;i===p&&r!==f&&o===v&&(u++,q(r)===q(f)&&a++,Q(r)===Q(f)&&s++)}if(u>0)return a>0&&s>0?K(r):s>0?K(r).charAt(1):K(r).charAt(0);return""}(t,n);"p"!==t.piece&&(e+=t.piece.toUpperCase()+r),t.flags&(l.CAPTURE|l.EP_CAPTURE)&&("p"===t.piece&&(e+=K(t.from)[0]),e+="x"),e+=K(t.to),t.flags&l.PROMOTION&&(e+="="+t.promotion.toUpperCase())}return M(t),L()&&(D()?e+="#":e+="+"),F(),e}function G(t){return t.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function B(t,n){for(var e=c.a8;e<=c.h1;e++)if(136&e)e+=7;else if(null!=v[e]&&v[e].color===t){var r=v[e],o=e-n,s=o+119;if(i[s]&1<<a[r.type]){if("p"===r.type){if(o>0){if("w"===r.color)return!0}else if("b"===r.color)return!0;continue}if("n"===r.type||"k"===r.type)return!0;for(var l=u[s],f=e+l,p=!1;f!==n;){if(null!=v[f]){p=!0;break}f+=l}if(!p)return!0}}return!1}function R(t){return B(V(t),p[t])}function L(){return R(h)}function D(){return L()&&0===P().length}function I(){return!L()&&0===P().length}function W(){for(var t={},n=[],e=0,r=0,o=c.a8;o<=c.h1;o++)if(r=(r+1)%2,136&o)o+=7;else{var i=v[o];i&&(t[i.type]=i.type in t?t[i.type]+1:1,"b"===i.type&&n.push(r),e++)}if(2===e)return!0;if(3===e&&(1===t.b||1===t.n))return!0;if(e===t.b+2){var u=0,a=n.length;for(o=0;o<a;o++)u+=n[o];if(0===u||u===a)return!0}return!1}function $(){for(var t=[],n={},e=!1;;){var r=F();if(!r)break;t.push(r)}for(;;){var o=k().split(" ").slice(0,4).join(" ");if(n[o]=o in n?n[o]+1:1,n[o]>=3&&(e=!0),!t.length)break;M(t.pop())}return e}function M(t){var n=h,e=V(n);if(function(t){A.push({move:t,kings:{b:p.b,w:p.w},turn:h,castling:{b:g.b,w:g.w},ep_square:m,half_moves:d,move_number:b})}(t),v[t.to]=v[t.from],v[t.from]=null,t.flags&l.EP_CAPTURE&&("b"===h?v[t.to-16]=null:v[t.to+16]=null),t.flags&l.PROMOTION&&(v[t.to]={type:t.promotion,color:n}),"k"===v[t.to].type){if(p[v[t.to].color]=t.to,t.flags&l.KSIDE_CASTLE){var r=t.to-1,o=t.to+1;v[r]=v[o],v[o]=null}else if(t.flags&l.QSIDE_CASTLE){r=t.to+1,o=t.to-2;v[r]=v[o],v[o]=null}g[n]=""}if(g[n])for(var i=0,u=f[n].length;i<u;i++)if(t.from===f[n][i].square&&g[n]&f[n][i].flag){g[n]^=f[n][i].flag;break}if(g[e])for(i=0,u=f[e].length;i<u;i++)if(t.to===f[e][i].square&&g[e]&f[e][i].flag){g[e]^=f[e][i].flag;break}m=t.flags&l.BIG_PAWN?"b"===h?t.to-16:t.to+16:-1,"p"===t.piece||t.flags&(l.CAPTURE|l.EP_CAPTURE)?d=0:d++,"b"===h&&b++,h=V(h)}function F(){var t=A.pop();if(null==t)return null;var n=t.move;p=t.kings,h=t.turn,g=t.castling,m=t.ep_square,d=t.half_moves,b=t.move_number;var e,r,o=h,i=V(h);if(v[n.from]=v[n.to],v[n.from].type=n.piece,v[n.to]=null,n.flags&l.CAPTURE)v[n.to]={type:n.captured,color:i};else if(n.flags&l.EP_CAPTURE){var u;u="b"===o?n.to-16:n.to+16,v[u]={type:"p",color:i}}n.flags&(l.KSIDE_CASTLE|l.QSIDE_CASTLE)&&(n.flags&l.KSIDE_CASTLE?(e=n.to+1,r=n.to-1):n.flags&l.QSIDE_CASTLE&&(e=n.to-2,r=n.to+1),v[e]=v[r],v[r]=null);return n}function j(t,n){var e=G(t);if(n){var r=e.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(r)var o=r[1],i=r[2],u=r[3],a=r[4]}for(var s=P(),l=0,f=s.length;l<f;l++){if(e===G(U(s[l]))||n&&e===G(U(s[l],!0)))return s[l];if(r&&(!o||o.toLowerCase()==s[l].piece)&&c[i]==s[l].from&&c[u]==s[l].to&&(!a||a.toLowerCase()==s[l].promotion))return s[l]}return null}function q(t){return t>>4}function Q(t){return 15&t}function K(t){var n=Q(t),e=q(t);return"abcdefgh".substring(n,n+1)+"87654321".substring(e,e+1)}function V(t){return"w"===t?"b":"w"}function Y(t){var n=function t(n){var e=n instanceof Array?[]:{};for(var r in n)e[r]="object"==typeof r?t(n[r]):n[r];return e}(t);n.san=U(n,!1),n.to=K(n.to),n.from=K(n.from);var e="";for(var r in l)l[r]&n.flags&&(e+=s[r]);return n.flags=e,n}function H(t){return t.replace(/^\s+|\s+$/g,"")}return S(void 0===t?n:t),{WHITE:"w",BLACK:"b",PAWN:"p",KNIGHT:"n",BISHOP:"b",ROOK:"r",QUEEN:"q",KING:"k",SQUARES:function(){for(var t=[],n=c.a8;n<=c.h1;n++)136&n?n+=7:t.push(K(n));return t}(),FLAGS:s,load:function(t){return S(t)},reset:function(){return C()},moves:function(t){for(var n=P(t),e=[],r=0,o=n.length;r<o;r++)void 0!==t&&"verbose"in t&&t.verbose?e.push(Y(n[r])):e.push(U(n[r],!1));return e},in_check:function(){return L()},in_checkmate:function(){return D()},in_stalemate:function(){return I()},in_draw:function(){return d>=100||I()||W()||$()},insufficient_material:function(){return W()},in_threefold_repetition:function(){return $()},game_over:function(){return d>=100||D()||I()||W()||$()},validate_fen:function(t){return N(t)},fen:function(){return k()},board:function(){for(var t=[],n=[],e=c.a8;e<=c.h1;e++)null==v[e]?n.push(null):n.push({type:v[e].type,color:v[e].color}),e+1&136&&(t.push(n),n=[],e+=8);return t},pgn:function(t){var n="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\n",e="object"==typeof t&&"number"==typeof t.max_width?t.max_width:0,r=[],o=!1;for(var i in E)r.push("["+i+' "'+E[i]+'"]'+n),o=!0;o&&A.length&&r.push(n);for(var u=[];A.length>0;)u.push(F());for(var a=[],s="";u.length>0;){var l=u.pop();A.length||"b"!==l.color?"w"===l.color&&(s.length&&a.push(s),s=b+"."):s=b+". ...",s=s+" "+U(l,!1),M(l)}if(s.length&&a.push(s),void 0!==E.Result&&a.push(E.Result),0===e)return r.join("")+a.join(" ");var c=0;for(i=0;i<a.length;i++)c+a[i].length>e&&0!==i?(" "===r[r.length-1]&&r.pop(),r.push(n),c=0):0!==i&&(r.push(" "),c++),r.push(a[i]),c+=a[i].length;return r.join("")},load_pgn:function(t,n){var r=void 0!==n&&"sloppy"in n&&n.sloppy;function o(t){return t.replace(/\\/g,"\\")}var i="object"==typeof n&&"string"==typeof n.newline_char?n.newline_char:"\r?\n",u=new RegExp("^(\\[((?:"+o(i)+")|.)*\\])(?:"+o(i)+"){2}"),a=u.test(t)?u.exec(t)[1]:"";C();var s=function(t,n){for(var e="object"==typeof n&&"string"==typeof n.newline_char?n.newline_char:"\r?\n",r={},i=t.split(new RegExp(o(e))),u="",a="",s=0;s<i.length;s++)u=i[s].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),a=i[s].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),H(u).length>0&&(r[u]=a);return r}(a,n);for(var l in s)T([l,s[l]]);if(!("1"!==s.SetUp||"FEN"in s&&S(s.FEN,!0)))return!1;var c=t.replace(a,"").replace(new RegExp(o(i),"g")," ");c=c.replace(/(\{[^}]+\})+?/g,"");for(var f=/(\([^\(\)]+\))+?/g;f.test(c);)c=c.replace(f,"");var v=H(c=(c=(c=c.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));v=v.join(",").replace(/,,+/g,",").split(",");for(var p="",h=0;h<v.length-1;h++){if(null==(p=j(v[h],r)))return!1;M(p)}if(p=v[v.length-1],e.indexOf(p)>-1)(function(t){for(var n in t)return!0;return!1})(E)&&void 0===E.Result&&T(["Result",p]);else{if(null==(p=j(p,r)))return!1;M(p)}return!0},header:function(){return T(arguments)},ascii:function(){return function(){for(var t="   +------------------------+\n",n=c.a8;n<=c.h1;n++){if(0===Q(n)&&(t+=" "+"87654321"[q(n)]+" |"),null==v[n])t+=" . ";else{var e=v[n].type;t+=" "+("w"===v[n].color?e.toUpperCase():e.toLowerCase())+" "}n+1&136&&(t+="|\n",n+=8)}return t+="   +------------------------+\n",t+="     a  b  c  d  e  f  g  h\n"}()},turn:function(){return h},move:function(t,n){var e=void 0!==n&&"sloppy"in n&&n.sloppy,r=null;if("string"==typeof t)r=j(t,e);else if("object"==typeof t)for(var o=P(),i=0,u=o.length;i<u;i++)if(t.from===K(o[i].from)&&t.to===K(o[i].to)&&(!("promotion"in o[i])||t.promotion===o[i].promotion)){r=o[i];break}if(!r)return null;var a=Y(r);return M(r),a},undo:function(){var t=F();return t?Y(t):null},clear:function(){return y()},put:function(t,n){return x(t,n)},get:function(t){return _(t)},remove:function(t){return function(t){var n=_(t);return v[c[t]]=null,n&&"k"===n.type&&(p[n.color]=-1),w(k()),n}(t)},perft:function(t){return function t(n){for(var e=P({legal:!1}),r=0,o=h,i=0,u=e.length;i<u;i++){if(M(e[i]),!R(o))if(n-1>0)r+=t(n-1);else r++;F()}return r}(t)},square_color:function(t){if(t in c){var n=c[t];return(q(n)+Q(n))%2==0?"light":"dark"}return null},history:function(t){for(var n=[],e=[],r=(void 0!==t&&"verbose"in t&&t.verbose);A.length>0;)n.push(F());for(;n.length>0;){var o=n.pop();r?e.push(Y(o)):e.push(U(o)),M(o)}return e}}};
/* @license
 * Copyright (c) 2018, Jeff Hlywa (jhlywa@gmail.com)
 * Released under the BSD license
 * https://github.com/jhlywa/chess.js/blob/master/LICENSE
 */n.Chess=o,void 0===(r=function(){return o}.call(n,e,n,t))||(t.exports=r)},function(t,n,e){"use strict";e.r(n),e.d(n,"StringBuilder",(function(){return a})),e.d(n,"Utils",(function(){return s})),e.d(n,"pgnReader",(function(){return l}));var r=e(0),o=e.n(r),i=e(1),u=e.n(i);function a(t){let n={};n.strings=new Array("");let e=function(t){t&&n.strings.push(t)};return e(t),{append:e,toString:function(){return n.strings.join("")},isEmpty:function(){for(let t=0;t<n.strings.length;t++)if(n.strings[t].length>0)return!1;return!0},lastChar:function(){return 0===n.strings.length?null:n.strings[n.strings.length-1].slice(-1)}}}function s(){let t=Array.isArray,n=Math.pow(2,53)-1,e=function(t){const e=o(t);return"number"==typeof e&&e>=0&&e<=n},r=t||function(t){return Array.isArray(t)},o=(i="length",function(t){return null==t?void 0:t[i]});var i;return{pvEach:function(t,n,r){let o,i;if(n=function(t,n,e){if(void 0===n)return t;switch(null==e?3:e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)};case 4:return function(e,r,o,i){return t.call(n,e,r,o,i)}}return function(){return t.apply(n,arguments)}}(n,r),e(t))for(o=0,i=t.length;o<i;o++)n(t[o],o,t);else{let e=Object.keys(t);for(o=0,i=e.length;o<i;o++)n(t[e[o]],e[o],t)}return t},pvIsElement:function(t){return!(!t||1!==t.nodeType)},pvIsEmpty:function(t){return null==t||(e(t)&&(r(t)||function(t){return"[object String]"===toString.call(t)}(t)||function(t){return"[object Arguments]"===toString.call(t)}(t))?0===t.length:0===Object.keys(t).length)}}}const l=function(t){const n={};let e=new s;n.configuration=function(t){return void 0===t.pgn&&(void 0===t.pgnFile?t.pgn="":t.pgn=function(t){const n=new XMLHttpRequest;if(n.open("GET",t,!1),n.send(),200===n.status)return n.responseText}(t.pgnFile)),Object.assign({notation:"short",position:"start",locale:"en"},t)}(t);const r=new u.a,i=function(){"start"===n.configuration.position?r.reset():r.load(n.configuration.position)};n.PGN_TAGS={event:"the name of the tournament or match event",site:"the location of the event",date:"the starting date of the game (format: YYYY.MM.TT)",round:"the playing round ordinal of the game",white:"the player of the white pieces (last name, pre name)",black:"the player of the black pieces (last name, pre name)",result:"the result of the game (1 - 0, 1/2 - 1/2, 0 - 1)",board:"the board number in a team event",eco:"ECO-Opening-Key (ECO = 'Encyclopaedia of Chess Openings')",whitemyelo:"myELO-score white (at the beginning of the game)",blackmyelo:"myELO-score black (at the beginning of the game)",whitedays:"rate in days for white",blackdays:"rate in days for black",mychessno:"identification-no. of the game on the myChess.de - server",annotator:"The person providing notes to the game.",plycount:"String value denoting total number of half-moves played.",timecontrol:"40/7200:3600 (moves per seconds: sudden death seconds)",time:'Time the game started, in "HH:MM:SS" format, in local clock time.',termination:'Gives more details about the termination of the game. It may be "abandoned", "adjudication" (result determined by third-party adjudication), "death", "emergency", "normal", "rules infraction", "time forfeit", or "unterminated".',mode:'"OTB" (over-the-board) "ICS" (Internet Chess Server)',setup:'"0": position is start position, "1": tag FEN defines the position',fen:'Alternative start position, tag SetUp has to be set to "1"'},n.PROMOTIONS={q:"queen",r:"rook",b:"bishop",n:"knight"},n.NAGs=new Array(220),n.NAGs[1]="!",n.NAGs[2]="?",n.NAGs[3]="‼",n.NAGs[4]="⁇",n.NAGs[5]="⁉",n.NAGs[6]="⁈",n.NAGs[7]="□",n.NAGs[10]="=",n.NAGs[13]="∞",n.NAGs[14]="⩲",n.NAGs[15]="⩱",n.NAGs[16]="±",n.NAGs[17]="∓",n.NAGs[18]="+−",n.NAGs[19]="-+",n.NAGs[22]="⨀",n.NAGs[23]="⨀",n.NAGs[32]="⟳",n.NAGs[33]="⟳",n.NAGs[36]="→",n.NAGs[37]="→",n.NAGs[40]="↑",n.NAGs[41]="↑",n.NAGs[44]="=∞",n.NAGs[132]="⇆",n.NAGs[133]="⇆",n.NAGs[136]="⊕",n.NAGs[140]="∆",n.NAGs[146]="N",n.NAGs[220]="D",n.NAGs[221]="D",n.PGN_NAGS={};for(let t=0;t<n.NAGs.length;t++)n.PGN_NAGS[n.NAGs[t]]=t;n.PGN_NAGS["!!"]=3,n.PGN_NAGS["??"]=4,n.PGN_NAGS["!?"]=5,n.PGN_NAGS["?!"]=6;const l=function(t){let e="";if(null==t)return e;for(let r=0;r<t.length;r++){const o=parseInt(t[r].substring(1));if(220!==o){const t=n.NAGs[o];e+=void 0!==t?t:"$"+o}}return e},c=function(t){return"P"===t?"":t},f=function(t){let e=t.notation;if(void 0===e.row)return e.notation;const r=e.fig?c(e.fig):"",o=e.disc?e.disc:"",i=e.strike?e.strike:"",u=e.check?e.check:"",a=e.mate?e.mate:"",s=e.promotion?"="+c(e.promotion.substring(1,2)):"";return"short"===n.configuration.notation?r+o+i+e.col+e.row+s+u+a:"long"===n.configuration.notation?r+t.from+(e.strike?i:"-")+t.to+s+u+a:void 0};let v=function(){if(n.configuration.manyGames)return p(),h(n.games[0]),n;let t=o.a.parse(n.configuration.pgn,{startRule:"game"});return n.games=[t],h(t),n},p=function(){n.games=n.games=o.a.parse(n.configuration.pgn,{startRule:"games"})},h=function(t){let e="number"==typeof t?n.games[t]:t;if(n.tags=e.tags,n.moves=e.moves,function(){if(n.tags.SetUp){const t=n.tags.SetUp;n.configuration.position="0"===t?"start":n.tags.FEN}n.tags.Result&&(n.endGame=n.tags.Result)}(),g(e.moves),n.configuration.startPlay&&n.configuration.hideMovesBefore){let t=y(n.configuration.startPlay),e=S();n.configuration.startPlay=null,n.configuration.hideMovesBefore=!1,n.configuration.pgn=e,n.configuration.position=t,v()}};const g=function(t){const r=t;!function(t){"string"==typeof t[t.length-1]&&(n.endGame=t.pop())}(r),N(r),"b"===n.configuration.position.split(/\s+/)[1]&&m(0)&&"w"===n.moves[0].turn&&e.pvEach(T(),(function(t){t.turn="w"===t.turn?"b":"w"})),e.pvEach(T(),(function(t){for(let n=0;n<t.variations.length;n++)t.variations[n]=t.variations[n][0]}))},m=function(t){return T().length>t},d=function(t){if(!m(t))return!0;const n=T()[t];return null===n||(0!==t||!n)&&void 0},b=function(t){return T()[t]},A=function(t,n){if(0===arguments.length){const t=b(0);A(t,0)}else if(t.variationLevel=n,void 0!==t.next&&A(b(t.next),n),t.variations)for(let e=0;e<t.variations.length;e++)A(t.variations[e],n+1)};let E=function(t){const e=function(t,n){const e=t[n];return t.splice(n,1),e};if(d(t))return;if(0===t)return void(n.moves=[]);let r=b(t);if(C(r)){const t=b(b(r.prev).next).variations;for(let n=0;t.length;n++)if(t[n]===r)return e(t,n),void 0!==r.next&&E(r.next),void(T()[r.index]=null)}if(0===r.variations.length)return void 0!==r.next&&null!==r.next&&E(r.next),n.moves[r.prev].next=null,void(n.moves[t]=null);if(r.variations.length>0){void 0!==r.next&&E(r.next);let o=e(r.variations,0),i=o.variationLevel;n.moves[r.prev].next=o.index,n.moves[t]=null,A(o,i-1)}};let y=function(t){let e=function(t){let r=n.moves[t].fen;return n.moves[t]=null,t<=0||e(t-1),r};if(void 0===t)return;if(null===t)return;if(t<=0)return;let r=e(t-1);return b(t).prev=null,r};const C=function(t){return t.variationLevel>0&&("number"!=typeof t.prev||T()[t.prev].next!==t.index)},S=function(){function t(t){t.isEmpty()||" "===t.lastChar()||t.append(" ")}const e=function(n,e){null!=n&&(t(e),e.append("{"),e.append(n),e.append("}"))},r=function(n,e){t(e),e.append("("),o(n,e),t(e),e.append(")")},o=function(n,i){if(null==n)return;!function(t,n){e(t.commentMove,n)}(n,i),function(n,e){t(e),"w"===n.turn?(e.append(""+n.moveNumber),e.append(".")):C(n)&&(e.append(""+n.moveNumber),e.append("..."))}(n,i),function(t,n){e(t.commentBefore,n)}(n,i),function(n,e){t(e),e.append(n.notation.notation)}(n,i),function(t,n){t.nag&&t.nag.forEach((function(t){n.append(t)}))}(n,i),function(t,n){e(t.commentAfter,n)}(n,i),function(t,n){if((t=>t.commentDiag&&(t.commentDiag.colorArrows&&t.commentDiag.colorArrows.length>0||t.commentDiag.colorFields&&t.commentDiag.colorFields.length>0))(t)){let r=a(""),o=!0;r.append("[%csl "),(t=>t.commentDiag.colorFields||[])(t).forEach(t=>{o?r.append(""):r.append(","),o=!1,r.append(t)}),r.append("]"),o=!0,r.append("[%cal "),(t=>t.commentDiag.colorArrows||[])(t).forEach(t=>{o?r.append(""):r.append(","),o=!1,r.append(t)}),r.append("]"),e(r.toString(),n)}}(n,i),function(t,n){for(let e=0;e<t.variations.length;e++)r(t.variations[e],n)}(n,i);const u=function(t){return t.next?b(t.next):null}(n);o(u,i)},i=a("");let u=0;for(;null===b(u);)u+=1;return s=b(u),o(s,l=i),function(t){n.endGame&&(t.append(" "),t.append(n.endGame))}(l),l.toString();var s,l},N=function(t){n.moves=[];let o=-1;const u=function(t,a,s){let l=null!=s?n.moves[s]:null;e.pvEach(t,(function(t,c){o++,t.variationLevel=a,n.moves.push(t),c>0&&(n.moves[o-1].variationLevel>a?(l=function(t,e){for(;e>=0;){if(n.moves[e].variationLevel===t)return n.moves[e];e--}return null}(a,o-1),s=l.index):(s=o-1,l=n.moves[s])),function(t,n,e,r){null!=r&&(e.prev=n,r.next||(r.next=t)),e.index=t}(o,s,t,l),"number"==typeof t.prev?r.load(b(t.prev).fen):i();let f=r.move(t.notation.notation,{sloppy:!0});if(null===f)throw"No legal move: "+t.notation.notation;let v=r.fen();t.fen=v,t.from=f.from,t.to=f.to,t.notation.notation=f.san,"c"===f.flags&&(t.notation.strike="x"),r.in_checkmate()?t.notation.check="#":r.in_check()&&(t.notation.check="+"),t.moveNumber=function(t){const n=t.split(/\s+/),e=parseInt(n[5],10);return"b"===n[1]?e:e-1}(v),e.pvEach(t.variations,(function(t){u(t,a+1,s)}))}))};u(t,0,null)};const k=function(t,n){if(n.push(t),t.variations)for(let e=0;e<t.variations.length;e++)k(t.variations[e],n);return t.next?k(b(t.next),n):n};function T(){return void 0!==n.moves||v(),n.moves}return{configuration:n.configuration,deleteMove:E,deleteMovesBefore:y,isDeleted:d,promoteMove:function(t){const n=function(t){return C(t)?t:n(b(t.prev))},e=b(t);if(void 0===e.variationLevel||0===e.variationLevel)return;const r=n(e),o=b(b(r.prev).next);let i;for(let t=0;t<o.variations.length;t++)o.variations[t]===r&&(i=t);if(i>0){let t=o.variations[i-1];o.variations[i-1]=o.variations[i],o.variations[i]=t}else{let t=o;const n=o.variations;b(o.prev).next=r.index,t.variations=r.variations,r.variations=n,r.variations[0]=t}A()},readMoves:g,findMove:function(t){if(!isNaN(t)){t-=1;let n=b(0);for(;t>0;)t-=1,n=b(n.next);return n}let n=T();for(let e of n){if(e.fen.startsWith(t))return e;if(e.notation.notation===t)return e}},getMoves:T,getOrderedMoves:k,getMove:b,getEndGame:function(){return n.endGame},getTags:function(){return void 0!==n.tags||v(),n.tags},getGames:function(){return void 0!==n.games||v(),n.games},load_one:h,getParser:()=>o.a,write_pgn:S,nag_to_symbol:l,startVariation:C,startMainLine:function(t){return 0===t.variationLevel&&"number"!=typeof t.prev},endVariation:function(t){return t.variationLevel>0&&!t.next},afterMoveWithVariation:function(t){return T()[t.prev]&&T()[t.prev].variations.length>0},changeNag:function(t,e,r){let o=b(e);null==o.nag&&(o.nag=[]);let i="$"===t[0]?t:function(t){const e=n.PGN_NAGS[t];return"undefined"===e?null:"$"+e}(t);if(r)-1===o.nag.indexOf(i)&&o.nag.push(i);else{let t=o.nag.indexOf(i);t>-1&&o.nag.splice(t,1)}},clearNags:function(t){b(t).nag=[]},addMove:function(t,n){function e(t){i();let n=r.move(t);return n?(void 0===b(0)?null:b(0).notation.notation)===n.san?0:function(t){if(void 0===b(0))return null;let n,e=b(0).variations;for(n in e)if(e[n].notation.notation===t.san)return e[n].moveNumber;return null}(n):null}let o=function(t,n){if(null==n)return e(t);let o=b(n);if(void 0===o)return null;r.load(o.fen);let i=r.move(t),u=b(o.next);if(void 0===u)return null;if(u.notation.notation===i.san)return o.next;{let t=b(o.next);for(let n=0;n<t.variations.length;n++){let e=t.variations[n];if(e.notation.notation===i.san)return e.index}}return null}(t,n);if("number"==typeof o)return o;let u={};u.from=t.from,u.to=t.to,u.notation={},u.variations=[],null==n?(i(),u.turn=r.turn(),u.moveNumber=1):(r.load(b(n).fen),u.turn=function(t){return"w"===b(t).turn?"b":"w"}(n),"w"===u.turn?u.moveNumber=b(n).moveNumber+1:u.moveNumber=b(n).moveNumber);let a=r.move(t);u.fen=r.fen(),"O"!==a.san.substring(0,1)?(u.notation.notation=a.san,u.notation.col=a.to.substring(0,1),u.notation.row=a.to.substring(1,2),"p"!==a.piece&&(u.notation.fig=a.piece.charAt(0).toUpperCase()),a.promotion&&(u.notation.promotion="="+a.promotion.toUpperCase()),(a.flags.includes(r.FLAGS.CAPTURE)||a.flags.includes(r.FLAGS.EP_CAPTURE))&&(u.notation.strike="x"),u.notation.ep=a.flags.includes(r.FLAGS.EP_CAPTURE),r.in_check()&&(r.in_checkmate()?u.notation.mate="#":u.notation.check="+")):u.notation.notation=a.san,T().push(u),u.prev=n;let s=T().length-1;return u.index=s,function(t,n,e){let r=b(n);if(void 0===r){if(0===e)return;return b(0).variations.push(t),void(t.variationLevel=1)}r.next?(b(r.next).variations.push(t),t.variationLevel=(r.variationLevel?r.variationLevel:0)+1,"b"===t.turn&&(t.moveNumber=r.moveNumber)):(r.next=e,t.variationLevel=r.variationLevel)}(u,n,s),s},has_diagram_nag:function(t){return void 0!==t.nag&&(null!=t.nag&&t.nag.indexOf("$220")>-1)},PGN_NAGS:n.PGN_NAGS,PROMOTIONS:n.PROMOTIONS,NAGS:n.NAGs,san:f,sanWithNags:function(t){let n=f(t);return t.nag&&(n+=l(t.nag)),n},game:r,load_pgn:v,possibleMoves:function(t){const n={};return t.SQUARES.forEach(e=>{const r=t.moves({square:e,verbose:!0});r.length&&(n[e]=r.map(t=>t.to))}),n},setShapes:function(t,n){t.commentDiag||(t.commentDiag={}),t.commentDiag.colorArrows=[],t.commentDiag.colorFields=[],n.forEach(n=>{if(n.dest){let e=n.brush.slice(0,1).toUpperCase(),r=n.orig+n.dest;t.commentDiag.colorArrows.push(e+r)}else{let e=n.brush.slice(0,1).toUpperCase(),r=n.orig;t.commentDiag.colorFields.push(e+r)}})}}}},function(t,n,e){"use strict";function r(t,n,e,o){this.message=t,this.expected=n,this.found=e,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}!function(t,n){function e(){this.constructor=t}e.prototype=n.prototype,t.prototype=new e}(r,Error),r.buildMessage=function(t,n){var e={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var n,e="";for(n=0;n<t.parts.length;n++)e+=t.parts[n]instanceof Array?i(t.parts[n][0])+"-"+i(t.parts[n][1]):i(t.parts[n]);return"["+(t.inverted?"^":"")+e+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}return"Expected "+function(t){var n,r,o,i=new Array(t.length);for(n=0;n<t.length;n++)i[n]=(o=t[n],e[o.type](o));if(i.sort(),i.length>0){for(n=1,r=1;n<i.length;n++)i[n-1]!==i[n]&&(i[r]=i[n],r++);i.length=r}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(n)+" found."},t.exports={SyntaxError:r,parse:function(t,n){n=void 0!==n?n:{};var e,o={},i={pgn:sr,tags:Xe,game:ze,games:function(){var t,n,e,r,i,u,s;if(t=We,tr()!==o){if(n=We,(e=ze())!==o){for(r=[],i=We,(u=nr())!==o&&(s=ze())!==o?(i,u=a(e,s),i=u):(We=i,i=o);i!==o;)r.push(i),i=We,(u=nr())!==o&&(s=ze())!==o?(i,u=a(e,s),i=u):(We=i,i=o);r!==o?(n,e=[e].concat(r),n=e):(We=n,n=o)}else We=n,n=o;n===o&&(n=null),n!==o?(t,t=n):(We=t,t=o)}else We=t,t=o;return t}},u=sr,a=function(t,n){return n},s=qe("Event",!1),l=qe("event",!1),c=qe("Site",!1),f=qe("site",!1),v=qe("Date",!1),p=qe("date",!1),h=qe("Round",!1),g=qe("round",!1),m=qe("White",!1),d=qe("Black",!1),b=qe("black",!1),A=qe("Result",!1),E=qe("result",!1),y=qe("WhiteTitle",!1),C=qe("Whitetitle",!1),S=qe("whitetitle",!1),N=qe("BlackTitle",!1),k=qe("Blacktitle",!1),T=qe("blacktitle",!1),w=qe("WhiteELO",!1),_=qe("WhiteElo",!1),x=qe("Whiteelo",!1),O=qe("whiteelo",!1),P=qe("BlackELO",!1),U=qe("BlackElo",!1),G=qe("Blackelo",!1),B=qe("blackelo",!1),R=qe("WhiteUSCF",!1),L=qe("WhiteUscf",!1),D=qe("Whiteuscf",!1),I=qe("whiteuscf",!1),W=qe("BlackUSCF",!1),$=qe("BlackUscf",!1),M=qe("Blackuscf",!1),F=qe("blackuscf",!1),j=qe("WhiteNA",!1),q=qe("WhiteNa",!1),Q=qe("Whitena",!1),K=qe("whitena",!1),V=qe("BlackNA",!1),Y=qe("BlackNa",!1),H=qe("Blackna",!1),Z=qe("blackna",!1),z=qe("WhiteType",!1),X=qe("Whitetype",!1),J=qe("whitetype",!1),tt=qe("BlackType",!1),nt=qe("Blacktype",!1),et=qe("blacktype",!1),rt=qe("EventDate",!1),ot=qe("Eventdate",!1),it=qe("eventdate",!1),ut=qe("EventSponsor",!1),at=qe("Eventsponsor",!1),st=qe("eventsponsor",!1),lt=qe("Section",!1),ct=qe("section",!1),ft=qe("Stage",!1),vt=qe("stage",!1),pt=qe("Board",!1),ht=qe("board",!1),gt=qe("Opening",!1),mt=qe("opening",!1),dt=qe("Variation",!1),bt=qe("variation",!1),At=qe("SubVariation",!1),Et=qe("Subvariation",!1),yt=qe("subvariation",!1),Ct=qe("ECO",!1),St=qe("Eco",!1),Nt=qe("eco",!1),kt=qe("NIC",!1),Tt=qe("Nic",!1),wt=qe("nic",!1),_t=qe("Time",!1),xt=qe("time",!1),Ot=qe("UTCTime",!1),Pt=qe("UTCtime",!1),Ut=qe("UtcTime",!1),Gt=qe("Utctime",!1),Bt=qe("utctime",!1),Rt=qe("UTCDate",!1),Lt=qe("UTCdate",!1),Dt=qe("UtcDate",!1),It=qe("Utcdate",!1),Wt=qe("utcdate",!1),$t=qe("TimeControl",!1),Mt=qe("Timecontrol",!1),Ft=qe("timecontrol",!1),jt=qe("SetUp",!1),qt=qe("Setup",!1),Qt=qe("setup",!1),Kt=qe("FEN",!1),Vt=qe("Fen",!1),Yt=qe("fen",!1),Ht=qe("Termination",!1),Zt=qe("termination",!1),zt=qe("Annotator",!1),Xt=qe("annotator",!1),Jt=qe("Mode",!1),tn=qe("mode",!1),nn=qe("PlyCount",!1),en=qe("Plycount",!1),rn=qe("plycount",!1),on=Ke("whitespace"),un=/^[ \t\n\r]/,an=Qe([" ","\t","\n","\r"],!1,!1),sn=Ke("string"),ln=function(t){return t.join("")},cn=/^[a-zA-Z0-9]/,fn=Qe([["a","z"],["A","Z"],["0","9"]],!1,!1),vn=qe('"',!1),pn=/^[^\0-\x1F"\\]/,hn=Qe([["\0",""],'"',"\\"],!0,!1),gn=/^[0-9?]/,mn=Qe([["0","9"],"?"],!1,!1),dn=qe(".",!1),bn=qe("1-0",!1),An=qe("1:0",!1),En=qe("0-1",!1),yn=qe("0:1",!1),Cn=qe("1/2-1/2",!1),Sn=qe("*",!1),Nn=qe("-",!1),kn=/^[0-9]/,Tn=Qe([["0","9"]],!1,!1),wn=function(t){return parseInt(t.join(""),10)},_n=/^[^}]/,xn=Qe(["}"],!0,!1),On=qe("%csl",!1),Pn=qe("%cal",!1),Un=qe(",",!1),Gn=function(t,n){var e=[];e.push(t);for(var r=0;r<n.length;r++)e.push(n[r][2]);return e},Bn=qe("Y",!1),Rn=qe("G",!1),Ln=qe("R",!1),Dn=qe("B",!1),In=qe("{",!1),Wn=qe("}",!1),$n=qe("[",!1),Mn=qe("]",!1),Fn=qe("%",!1),jn=qe("clk",!1),qn=qe("egt",!1),Qn=qe("emt",!1),Kn=qe("mct",!1),Vn=qe(":",!1),Yn=qe("(",!1),Hn=qe(")",!1),Zn=Ke("integer"),zn=qe(" ",!1),Xn=qe("O-O-O",!1),Jn=qe("O-O",!1),te=qe("+-",!1),ne=qe("+",!1),ee=function(t){return t[1]},re=qe("$$$",!1),oe=qe("#",!1),ie=qe("=",!1),ue=qe("$",!1),ae=qe("!!",!1),se=qe("??",!1),le=qe("!?",!1),ce=qe("?!",!1),fe=qe("!",!1),ve=qe("?",!1),pe=qe("‼",!1),he=qe("⁇",!1),ge=qe("⁉",!1),me=qe("⁈",!1),de=qe("□",!1),be=qe("∞",!1),Ae=qe("⩲",!1),Ee=qe("⩱",!1),ye=qe("±",!1),Ce=qe("∓",!1),Se=qe("-+",!1),Ne=qe("⨀",!1),ke=qe("⟳",!1),Te=qe("→",!1),we=qe("↑",!1),_e=qe("⇆",!1),xe=qe("D",!1),Oe=/^[RNBQKP]/,Pe=Qe(["R","N","B","Q","K","P"],!1,!1),Ue=/^[RNBQ]/,Ge=Qe(["R","N","B","Q"],!1,!1),Be=/^[a-h]/,Re=Qe([["a","h"]],!1,!1),Le=/^[1-8]/,De=Qe([["1","8"]],!1,!1),Ie=qe("x",!1),We=0,$e=[{line:1,column:1}],Me=0,Fe=[],je=0;if("startRule"in n){if(!(n.startRule in i))throw new Error("Can't start parsing from rule \""+n.startRule+'".');u=i[n.startRule]}function qe(t,n){return{type:"literal",text:t,ignoreCase:n}}function Qe(t,n,e){return{type:"class",parts:t,inverted:n,ignoreCase:e}}function Ke(t){return{type:"other",description:t}}function Ve(n){var e,r=$e[n];if(r)return r;for(e=n-1;!$e[e];)e--;for(r={line:(r=$e[e]).line,column:r.column};e<n;)10===t.charCodeAt(e)?(r.line++,r.column=1):r.column++,e++;return $e[n]=r,r}function Ye(t,n){var e=Ve(t),r=Ve(n);return{start:{offset:t,line:e.line,column:e.column},end:{offset:n,line:r.line,column:r.column}}}function He(t){We<Me||(We>Me&&(Me=We,Fe=[]),Fe.push(t))}function Ze(t,n,e){return new r(r.buildMessage(t,n),t,n,e)}function ze(){var t,n,e;return t=We,(n=Xe())===o&&(n=null),n!==o&&(e=sr())!==o?(t,t=n={tags:n,moves:e[0]}):(We=t,t=o),t}function Xe(){var t,n,e,r,i,u,s,l;if(t=We,tr()!==o){if(n=We,(e=Je())!==o){for(r=[],i=We,tr()!==o&&(u=Je())!==o?(i,i=a(0,u)):(We=i,i=o);i!==o;)r.push(i),i=We,tr()!==o&&(u=Je())!==o?(i,i=a(0,u)):(We=i,i=o);r!==o?(n,l={},[e].concat(r).forEach((function(t){l[t.name]=t.value})),n=e=l):(We=n,n=o)}else We=n,n=o;n===o&&(n=null),n!==o&&(e=tr())!==o?(t,t=null!==(s=n)?s:{}):(We=t,t=o)}else We=t,t=o;return t}function Je(){var n,e;return n=We,Sr()!==o&&(e=function(){var n,e,r;n=We,(e=function(){var n;"Event"===t.substr(We,5)?(n="Event",We+=5):(n=o,0===je&&He(s));n===o&&("event"===t.substr(We,5)?(n="event",We+=5):(n=o,0===je&&He(l)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,n=e={name:"Event",value:r}):(We=n,n=o);n===o&&(n=We,(e=function(){var n;"Site"===t.substr(We,4)?(n="Site",We+=4):(n=o,0===je&&He(c));n===o&&("site"===t.substr(We,4)?(n="site",We+=4):(n=o,0===je&&He(f)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Site",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Date"===t.substr(We,4)?(n="Date",We+=4):(n=o,0===je&&He(v));n===o&&("date"===t.substr(We,4)?(n="date",We+=4):(n=o,0===je&&He(p)));return n}())!==o&&tr()!==o&&(r=ir())!==o?(n,e=function(t){return{name:"Date",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Round"===t.substr(We,5)?(n="Round",We+=5):(n=o,0===je&&He(h));n===o&&("round"===t.substr(We,5)?(n="round",We+=5):(n=o,0===je&&He(g)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Round",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"WhiteTitle"===t.substr(We,10)?(n="WhiteTitle",We+=10):(n=o,0===je&&He(y));n===o&&("Whitetitle"===t.substr(We,10)?(n="Whitetitle",We+=10):(n=o,0===je&&He(C)),n===o&&("whitetitle"===t.substr(We,10)?(n="whitetitle",We+=10):(n=o,0===je&&He(S))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"WhiteTitle",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"BlackTitle"===t.substr(We,10)?(n="BlackTitle",We+=10):(n=o,0===je&&He(N));n===o&&("Blacktitle"===t.substr(We,10)?(n="Blacktitle",We+=10):(n=o,0===je&&He(k)),n===o&&("blacktitle"===t.substr(We,10)?(n="blacktitle",We+=10):(n=o,0===je&&He(T))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"BlackTitle",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"WhiteELO"===t.substr(We,8)?(n="WhiteELO",We+=8):(n=o,0===je&&He(w));n===o&&("WhiteElo"===t.substr(We,8)?(n="WhiteElo",We+=8):(n=o,0===je&&He(_)),n===o&&("Whiteelo"===t.substr(We,8)?(n="Whiteelo",We+=8):(n=o,0===je&&He(x)),n===o&&("whiteelo"===t.substr(We,8)?(n="whiteelo",We+=8):(n=o,0===je&&He(O)))));return n}())!==o&&tr()!==o&&(r=ur())!==o?(n,e=function(t){return{name:"WhiteELO",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"BlackELO"===t.substr(We,8)?(n="BlackELO",We+=8):(n=o,0===je&&He(P));n===o&&("BlackElo"===t.substr(We,8)?(n="BlackElo",We+=8):(n=o,0===je&&He(U)),n===o&&("Blackelo"===t.substr(We,8)?(n="Blackelo",We+=8):(n=o,0===je&&He(G)),n===o&&("blackelo"===t.substr(We,8)?(n="blackelo",We+=8):(n=o,0===je&&He(B)))));return n}())!==o&&tr()!==o&&(r=ur())!==o?(n,e=function(t){return{name:"BlackELO",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"WhiteUSCF"===t.substr(We,9)?(n="WhiteUSCF",We+=9):(n=o,0===je&&He(R));n===o&&("WhiteUscf"===t.substr(We,9)?(n="WhiteUscf",We+=9):(n=o,0===je&&He(L)),n===o&&("Whiteuscf"===t.substr(We,9)?(n="Whiteuscf",We+=9):(n=o,0===je&&He(D)),n===o&&("whiteuscf"===t.substr(We,9)?(n="whiteuscf",We+=9):(n=o,0===je&&He(I)))));return n}())!==o&&tr()!==o&&(r=ar())!==o?(n,e=function(t){return{name:"WhiteUSCF",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"BlackUSCF"===t.substr(We,9)?(n="BlackUSCF",We+=9):(n=o,0===je&&He(W));n===o&&("BlackUscf"===t.substr(We,9)?(n="BlackUscf",We+=9):(n=o,0===je&&He($)),n===o&&("Blackuscf"===t.substr(We,9)?(n="Blackuscf",We+=9):(n=o,0===je&&He(M)),n===o&&("blackuscf"===t.substr(We,9)?(n="blackuscf",We+=9):(n=o,0===je&&He(F)))));return n}())!==o&&tr()!==o&&(r=ar())!==o?(n,e=function(t){return{name:"BlackUSCF",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"WhiteNA"===t.substr(We,7)?(n="WhiteNA",We+=7):(n=o,0===je&&He(j));n===o&&("WhiteNa"===t.substr(We,7)?(n="WhiteNa",We+=7):(n=o,0===je&&He(q)),n===o&&("Whitena"===t.substr(We,7)?(n="Whitena",We+=7):(n=o,0===je&&He(Q)),n===o&&("whitena"===t.substr(We,7)?(n="whitena",We+=7):(n=o,0===je&&He(K)))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"WhiteNA",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"BlackNA"===t.substr(We,7)?(n="BlackNA",We+=7):(n=o,0===je&&He(V));n===o&&("BlackNa"===t.substr(We,7)?(n="BlackNa",We+=7):(n=o,0===je&&He(Y)),n===o&&("Blackna"===t.substr(We,7)?(n="Blackna",We+=7):(n=o,0===je&&He(H)),n===o&&("blackna"===t.substr(We,7)?(n="blackna",We+=7):(n=o,0===je&&He(Z)))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"BlackNA",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"WhiteType"===t.substr(We,9)?(n="WhiteType",We+=9):(n=o,0===je&&He(z));n===o&&("Whitetype"===t.substr(We,9)?(n="Whitetype",We+=9):(n=o,0===je&&He(X)),n===o&&("whitetype"===t.substr(We,9)?(n="whitetype",We+=9):(n=o,0===je&&He(J))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"WhiteType",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"BlackType"===t.substr(We,9)?(n="BlackType",We+=9):(n=o,0===je&&He(tt));n===o&&("Blacktype"===t.substr(We,9)?(n="Blacktype",We+=9):(n=o,0===je&&He(nt)),n===o&&("blacktype"===t.substr(We,9)?(n="blacktype",We+=9):(n=o,0===je&&He(et))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"BlackType",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"White"===t.substr(We,5)?(n="White",We+=5):(n=o,0===je&&He(m));n===o&&("White"===t.substr(We,5)?(n="White",We+=5):(n=o,0===je&&He(m)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"White",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Black"===t.substr(We,5)?(n="Black",We+=5):(n=o,0===je&&He(d));n===o&&("black"===t.substr(We,5)?(n="black",We+=5):(n=o,0===je&&He(b)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Black",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Result"===t.substr(We,6)?(n="Result",We+=6):(n=o,0===je&&He(A));n===o&&("result"===t.substr(We,6)?(n="result",We+=6):(n=o,0===je&&He(E)));return n}())!==o&&tr()!==o&&(r=function(){var n,e;n=We,rr()!==o&&(e=function(){var n,e;n=We,"1-0"===t.substr(We,3)?(e="1-0",We+=3):(e=o,0===je&&He(bn));e!==o&&(n,e=e);(n=e)===o&&(n=We,"1:0"===t.substr(We,3)?(e="1:0",We+=3):(e=o,0===je&&He(An)),e!==o&&(n,e=e),(n=e)===o&&(n=We,"0-1"===t.substr(We,3)?(e="0-1",We+=3):(e=o,0===je&&He(En)),e!==o&&(n,e=e),(n=e)===o&&(n=We,"0:1"===t.substr(We,3)?(e="0:1",We+=3):(e=o,0===je&&He(yn)),e!==o&&(n,e=e),(n=e)===o&&(n=We,"1/2-1/2"===t.substr(We,7)?(e="1/2-1/2",We+=7):(e=o,0===je&&He(Cn)),e!==o&&(n,e=e),(n=e)===o&&(n=We,42===t.charCodeAt(We)?(e="*",We++):(e=o,0===je&&He(Sn)),e!==o&&(n,e=e),n=e)))));return n}())!==o&&rr()!==o?(n,n=e):(We=n,n=o);return n}())!==o?(n,e=function(t){return{name:"Result",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"EventDate"===t.substr(We,9)?(n="EventDate",We+=9):(n=o,0===je&&He(rt));n===o&&("Eventdate"===t.substr(We,9)?(n="Eventdate",We+=9):(n=o,0===je&&He(ot)),n===o&&("eventdate"===t.substr(We,9)?(n="eventdate",We+=9):(n=o,0===je&&He(it))));return n}())!==o&&tr()!==o&&(r=ir())!==o?(n,e=function(t){return{name:"EventDate",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"EventSponsor"===t.substr(We,12)?(n="EventSponsor",We+=12):(n=o,0===je&&He(ut));n===o&&("Eventsponsor"===t.substr(We,12)?(n="Eventsponsor",We+=12):(n=o,0===je&&He(at)),n===o&&("eventsponsor"===t.substr(We,12)?(n="eventsponsor",We+=12):(n=o,0===je&&He(st))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"EventSponsor",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Section"===t.substr(We,7)?(n="Section",We+=7):(n=o,0===je&&He(lt));n===o&&("section"===t.substr(We,7)?(n="section",We+=7):(n=o,0===je&&He(ct)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Section",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Stage"===t.substr(We,5)?(n="Stage",We+=5):(n=o,0===je&&He(ft));n===o&&("stage"===t.substr(We,5)?(n="stage",We+=5):(n=o,0===je&&He(vt)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Stage",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Board"===t.substr(We,5)?(n="Board",We+=5):(n=o,0===je&&He(pt));n===o&&("board"===t.substr(We,5)?(n="board",We+=5):(n=o,0===je&&He(ht)));return n}())!==o&&tr()!==o&&(r=ar())!==o?(n,e=function(t){return{name:"Board",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Opening"===t.substr(We,7)?(n="Opening",We+=7):(n=o,0===je&&He(gt));n===o&&("opening"===t.substr(We,7)?(n="opening",We+=7):(n=o,0===je&&He(mt)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Opening",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Variation"===t.substr(We,9)?(n="Variation",We+=9):(n=o,0===je&&He(dt));n===o&&("variation"===t.substr(We,9)?(n="variation",We+=9):(n=o,0===je&&He(bt)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Variation",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"SubVariation"===t.substr(We,12)?(n="SubVariation",We+=12):(n=o,0===je&&He(At));n===o&&("Subvariation"===t.substr(We,12)?(n="Subvariation",We+=12):(n=o,0===je&&He(Et)),n===o&&("subvariation"===t.substr(We,12)?(n="subvariation",We+=12):(n=o,0===je&&He(yt))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"SubVariation",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"ECO"===t.substr(We,3)?(n="ECO",We+=3):(n=o,0===je&&He(Ct));n===o&&("Eco"===t.substr(We,3)?(n="Eco",We+=3):(n=o,0===je&&He(St)),n===o&&("eco"===t.substr(We,3)?(n="eco",We+=3):(n=o,0===je&&He(Nt))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"ECO",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"NIC"===t.substr(We,3)?(n="NIC",We+=3):(n=o,0===je&&He(kt));n===o&&("Nic"===t.substr(We,3)?(n="Nic",We+=3):(n=o,0===je&&He(Tt)),n===o&&("nic"===t.substr(We,3)?(n="nic",We+=3):(n=o,0===je&&He(wt))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"NIC",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Time"===t.substr(We,4)?(n="Time",We+=4):(n=o,0===je&&He(_t));n===o&&("time"===t.substr(We,4)?(n="time",We+=4):(n=o,0===je&&He(xt)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Time",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"UTCTime"===t.substr(We,7)?(n="UTCTime",We+=7):(n=o,0===je&&He(Ot));n===o&&("UTCtime"===t.substr(We,7)?(n="UTCtime",We+=7):(n=o,0===je&&He(Pt)),n===o&&("UtcTime"===t.substr(We,7)?(n="UtcTime",We+=7):(n=o,0===je&&He(Ut)),n===o&&("Utctime"===t.substr(We,7)?(n="Utctime",We+=7):(n=o,0===je&&He(Gt)),n===o&&("utctime"===t.substr(We,7)?(n="utctime",We+=7):(n=o,0===je&&He(Bt))))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"UTCTime",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"UTCDate"===t.substr(We,7)?(n="UTCDate",We+=7):(n=o,0===je&&He(Rt));n===o&&("UTCdate"===t.substr(We,7)?(n="UTCdate",We+=7):(n=o,0===je&&He(Lt)),n===o&&("UtcDate"===t.substr(We,7)?(n="UtcDate",We+=7):(n=o,0===je&&He(Dt)),n===o&&("Utcdate"===t.substr(We,7)?(n="Utcdate",We+=7):(n=o,0===je&&He(It)),n===o&&("utcdate"===t.substr(We,7)?(n="utcdate",We+=7):(n=o,0===je&&He(Wt))))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"UTCDate",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"TimeControl"===t.substr(We,11)?(n="TimeControl",We+=11):(n=o,0===je&&He($t));n===o&&("Timecontrol"===t.substr(We,11)?(n="Timecontrol",We+=11):(n=o,0===je&&He(Mt)),n===o&&("timecontrol"===t.substr(We,11)?(n="timecontrol",We+=11):(n=o,0===je&&He(Ft))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"TimeControl",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"SetUp"===t.substr(We,5)?(n="SetUp",We+=5):(n=o,0===je&&He(jt));n===o&&("Setup"===t.substr(We,5)?(n="Setup",We+=5):(n=o,0===je&&He(qt)),n===o&&("setup"===t.substr(We,5)?(n="setup",We+=5):(n=o,0===je&&He(Qt))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"SetUp",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"FEN"===t.substr(We,3)?(n="FEN",We+=3):(n=o,0===je&&He(Kt));n===o&&("Fen"===t.substr(We,3)?(n="Fen",We+=3):(n=o,0===je&&He(Vt)),n===o&&("fen"===t.substr(We,3)?(n="fen",We+=3):(n=o,0===je&&He(Yt))));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"FEN",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Termination"===t.substr(We,11)?(n="Termination",We+=11):(n=o,0===je&&He(Ht));n===o&&("termination"===t.substr(We,11)?(n="termination",We+=11):(n=o,0===je&&He(Zt)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Termination",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Annotator"===t.substr(We,9)?(n="Annotator",We+=9):(n=o,0===je&&He(zt));n===o&&("annotator"===t.substr(We,9)?(n="annotator",We+=9):(n=o,0===je&&He(Xt)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Annotator",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"Mode"===t.substr(We,4)?(n="Mode",We+=4):(n=o,0===je&&He(Jt));n===o&&("mode"===t.substr(We,4)?(n="mode",We+=4):(n=o,0===je&&He(tn)));return n}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t){return{name:"Mode",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n;"PlyCount"===t.substr(We,8)?(n="PlyCount",We+=8):(n=o,0===je&&He(nn));n===o&&("Plycount"===t.substr(We,8)?(n="Plycount",We+=8):(n=o,0===je&&He(en)),n===o&&("plycount"===t.substr(We,8)?(n="plycount",We+=8):(n=o,0===je&&He(rn))));return n}())!==o&&tr()!==o&&(r=ar())!==o?(n,e=function(t){return{name:"PlyCount",value:t}}(r),n=e):(We=n,n=o),n===o&&(n=We,(e=function(){var n,e,r;n=We,e=[],cn.test(t.charAt(We))?(r=t.charAt(We),We++):(r=o,0===je&&He(fn));for(;r!==o;)e.push(r),cn.test(t.charAt(We))?(r=t.charAt(We),We++):(r=o,0===je&&He(fn));e!==o&&(n,e=ln(e));return n=e}())!==o&&tr()!==o&&(r=er())!==o?(n,e=function(t,n){return{name:t,value:n}}(e,r),n=e):(We=n,n=o))))))))))))))))))))))))))))))))))))));return n}())!==o&&Nr()!==o?(n,n=e):(We=n,n=o),n}function tr(){var n,e;for(je++,n=[],un.test(t.charAt(We))?(e=t.charAt(We),We++):(e=o,0===je&&He(an));e!==o;)n.push(e),un.test(t.charAt(We))?(e=t.charAt(We),We++):(e=o,0===je&&He(an));return je--,n===o&&(e=o,0===je&&He(on)),n}function nr(){var n,e;if(n=[],un.test(t.charAt(We))?(e=t.charAt(We),We++):(e=o,0===je&&He(an)),e!==o)for(;e!==o;)n.push(e),un.test(t.charAt(We))?(e=t.charAt(We),We++):(e=o,0===je&&He(an));else n=o;return n}function er(){var t,n,e;if(je++,t=We,rr()!==o){for(n=[],e=or();e!==o;)n.push(e),e=or();n!==o&&(e=rr())!==o?(t,t=ln(n)):(We=t,t=o)}else We=t,t=o;return je--,t===o&&(o,0===je&&He(sn)),t}function rr(){var n;return 34===t.charCodeAt(We)?(n='"',We++):(n=o,0===je&&He(vn)),n}function or(){var n;return pn.test(t.charAt(We))?(n=t.charAt(We),We++):(n=o,0===je&&He(hn)),n}function ir(){var n,e,r,i,u,a,s,l,c,f;return n=We,rr()!==o?(e=We,gn.test(t.charAt(We))?(r=t.charAt(We),We++):(r=o,0===je&&He(mn)),r!==o?(gn.test(t.charAt(We))?(i=t.charAt(We),We++):(i=o,0===je&&He(mn)),i!==o?(gn.test(t.charAt(We))?(u=t.charAt(We),We++):(u=o,0===je&&He(mn)),u!==o?(gn.test(t.charAt(We))?(a=t.charAt(We),We++):(a=o,0===je&&He(mn)),a!==o?e=r=[r,i,u,a]:(We=e,e=o)):(We=e,e=o)):(We=e,e=o)):(We=e,e=o),e!==o?(46===t.charCodeAt(We)?(r=".",We++):(r=o,0===je&&He(dn)),r!==o?(i=We,gn.test(t.charAt(We))?(u=t.charAt(We),We++):(u=o,0===je&&He(mn)),u!==o?(gn.test(t.charAt(We))?(a=t.charAt(We),We++):(a=o,0===je&&He(mn)),a!==o?i=u=[u,a]:(We=i,i=o)):(We=i,i=o),i!==o?(46===t.charCodeAt(We)?(u=".",We++):(u=o,0===je&&He(dn)),u!==o?(a=We,gn.test(t.charAt(We))?(s=t.charAt(We),We++):(s=o,0===je&&He(mn)),s!==o?(gn.test(t.charAt(We))?(l=t.charAt(We),We++):(l=o,0===je&&He(mn)),l!==o?a=s=[s,l]:(We=a,a=o)):(We=a,a=o),a!==o&&(s=rr())!==o?(n,c=i,f=a,n=e.join("")+"."+c.join("")+"."+f.join("")):(We=n,n=o)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o),n}function ur(){var n,e,r,i;return(n=ar())===o&&(n=We,(e=rr())!==o?(45===t.charCodeAt(We)?(r="-",We++):(r=o,0===je&&He(Nn)),r!==o&&(i=rr())!==o?n=e=[e,r,i]:(We=n,n=o)):(We=n,n=o)),n}function ar(){var n,e,r;if(n=We,rr()!==o){if(e=[],kn.test(t.charAt(We))?(r=t.charAt(We),We++):(r=o,0===je&&He(Tn)),r!==o)for(;r!==o;)e.push(r),kn.test(t.charAt(We))?(r=t.charAt(We),We++):(r=o,0===je&&He(Tn));else e=o;e!==o&&(r=rr())!==o?(n,n=wn(e)):(We=n,n=o)}else We=n,n=o;return n}function sr(){var t,n,e,r,i;return t=We,(n=function(){var t,n;t=We,(n=cr())!==o&&(t,n=n);return t=n}())!==o?((e=fr())===o&&(e=null),e!==o?(t,r=n,(i=e||[]).unshift(r),t=n=i):(We=t,t=o)):(We=t,t=o),t===o&&(t=We,(n=lr())!==o?((e=cr())===o&&(e=null),e!==o?(t,t=n=function(t,n){var e=n||[];return e.unshift(t),e}(n,e)):(We=t,t=o)):(We=t,t=o),t===o&&(t=We,(n=tr())!==o&&(t,n=[[]]),t=n)),t}function lr(){var t,n;return t=We,(n=fr())!==o&&(t,n=n),t=n}function cr(){var t,n,e,r,i,u,a,s,l,c,f,v,p,h,g,m,d,b,A;return t=We,tr()!==o?((n=pr())===o&&(n=null),n!==o&&tr()!==o?((e=_r())===o&&(e=null),e!==o&&tr()!==o?((r=pr())===o&&(r=null),r!==o&&tr()!==o&&(i=Ur())!==o&&tr()!==o?((u=Rr())===o&&(u=null),u!==o&&tr()!==o?((a=pr())===o&&(a=null),a!==o&&tr()!==o?((s=gr())===o&&(s=null),s!==o&&tr()!==o?((l=function t(){var n,e,r,i;n=We,Tr()!==o&&(e=cr())!==o&&wr()!==o&&tr()!==o?((r=t())===o&&(r=null),r!==o&&tr()!==o?((i=_r())===o&&(i=null),i!==o?(n,u=e,(a=r||[]).unshift(u),n=a):(We=n,n=o)):(We=n,n=o)):(We=n,n=o);var u,a;return n}())===o&&(l=null),l!==o?((c=fr())===o&&(c=null),c!==o?(t,f=n,v=r,p=i,h=u,g=a,m=s,d=l,b=c||[],(A={turn:"w"}).moveNumber=e,A.notation=p,A.commentBefore=v,A.commentAfter=g,A.commentMove=f,A.variations=d||[],A.nag=h||null,b.unshift(A),A.commentDiag=m,t=b):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o),t===o&&(t=vr()),t}function fr(){var t,n,e,r,i,u,a,s,l,c,f,v,p,h,g,m,d,b,A;return t=We,tr()!==o?((n=pr())===o&&(n=null),n!==o&&tr()!==o?((e=_r())===o&&(e=null),e!==o&&tr()!==o?((r=pr())===o&&(r=null),r!==o&&tr()!==o&&(i=Ur())!==o&&tr()!==o?((u=Rr())===o&&(u=null),u!==o&&tr()!==o?((a=pr())===o&&(a=null),a!==o&&tr()!==o?((s=gr())===o&&(s=null),s!==o&&tr()!==o?((l=function t(){var n,e,r;n=We,Tr()!==o&&(e=lr())!==o&&wr()!==o&&tr()!==o?((r=t())===o&&(r=null),r!==o?(n,i=e,(u=r||[]).unshift(i),n=u):(We=n,n=o)):(We=n,n=o);var i,u;return n}())===o&&(l=null),l!==o?((c=cr())===o&&(c=null),c!==o?(t,f=n,v=r,p=i,h=u,g=a,m=s,d=l,b=c||[],(A={turn:"b"}).moveNumber=e,A.notation=p,A.commentBefore=v,A.commentAfter=g,A.commentMove=f,A.variations=d||[],b.unshift(A),A.nag=h||null,A.commentDiag=m,t=b):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o)):(We=t,t=o),t===o&&(t=vr()),t}function vr(){var n,e;return n=We,"1:0"===t.substr(We,3)?(e="1:0",We+=3):(e=o,0===je&&He(An)),e!==o&&(n,e=["1:0"]),(n=e)===o&&(n=We,"0:1"===t.substr(We,3)?(e="0:1",We+=3):(e=o,0===je&&He(yn)),e!==o&&(n,e=["0:1"]),(n=e)===o&&(n=We,"1-0"===t.substr(We,3)?(e="1-0",We+=3):(e=o,0===je&&He(bn)),e!==o&&(n,e=["1-0"]),(n=e)===o&&(n=We,"0-1"===t.substr(We,3)?(e="0-1",We+=3):(e=o,0===je&&He(En)),e!==o&&(n,e=["0-1"]),(n=e)===o&&(n=We,"1/2-1/2"===t.substr(We,7)?(e="1/2-1/2",We+=7):(e=o,0===je&&He(Cn)),e!==o&&(n,e=["1/2-1/2"]),(n=e)===o&&(n=We,42===t.charCodeAt(We)?(e="*",We++):(e=o,0===je&&He(Sn)),e!==o&&(n,e=["*"]),n=e))))),n}function pr(){var t,n,e,r,i,u;if(t=We,(n=hr())!==o){for(e=[],r=We,(i=tr())!==o&&(u=hr())!==o?r=i=[i,u]:(We=r,r=o);r!==o;)e.push(r),r=We,(i=tr())!==o&&(u=hr())!==o?r=i=[i,u]:(We=r,r=o);e!==o?(t,t=n=function(t,n){for(var e=t,r=0;r<n.length;r++)e+=" "+n[r][1];return e}(n,e)):(We=t,t=o)}else We=t,t=o;return t}function hr(){var n,e,r,i,u;if(n=We,e=We,je++,r=gr(),je--,r===o?e=void 0:(We=e,e=o),e!==o)if((r=yr())!==o){if(i=[],_n.test(t.charAt(We))?(u=t.charAt(We),We++):(u=o,0===je&&He(xn)),u!==o)for(;u!==o;)i.push(u),_n.test(t.charAt(We))?(u=t.charAt(We),We++):(u=o,0===je&&He(xn));else i=o;i!==o&&(u=Cr())!==o?(n,n=e=i.join("").trim()):(We=n,n=o)}else We=n,n=o;else We=n,n=o;return n}function gr(){var t,n;return t=We,yr()!==o&&tr()!==o&&(n=function(){var t,n,e,r;if(t=We,(n=mr())!==o)if(tr()!==o){for(e=[],r=mr();r!==o;)e.push(r),r=mr();e!==o?(t,n=function(t,n){if(n){var e=n[0];return{...t,...e}}return t}(n,e),t=n):(We=t,t=o)}else We=t,t=o;else We=t,t=o;return t}())!==o&&tr()!==o&&Cr()!==o?(t,t=n):(We=t,t=o),t}function mr(){var n,e,r;return n=We,(e=function(){var n,e,r;n=We,Sr()!==o&&tr()!==o?("%csl"===t.substr(We,4)?(e="%csl",We+=4):(e=o,0===je&&He(On)),e!==o&&Or()!==o&&(r=function(){var n,e,r,i,u,a,s;if(n=We,(e=dr())!==o)if(tr()!==o){for(r=[],i=We,44===t.charCodeAt(We)?(u=",",We++):(u=o,0===je&&He(Un)),u!==o&&(a=tr())!==o&&(s=dr())!==o?i=u=[u,a,s]:(We=i,i=o);i!==o;)r.push(i),i=We,44===t.charCodeAt(We)?(u=",",We++):(u=o,0===je&&He(Un)),u!==o&&(a=tr())!==o&&(s=dr())!==o?i=u=[u,a,s]:(We=i,i=o);r!==o?(n,e=Gn(e,r),n=e):(We=n,n=o)}else We=n,n=o;else We=n,n=o;return n}())!==o&&tr()!==o&&Nr()!==o?(n,n=r):(We=n,n=o)):(We=n,n=o);return n}())!==o&&(n,(r={}).colorFields=e,e=r),(n=e)===o&&(n=We,(e=function(){var n,e,r;n=We,Sr()!==o&&tr()!==o?("%cal"===t.substr(We,4)?(e="%cal",We+=4):(e=o,0===je&&He(Pn)),e!==o&&Or()!==o&&(r=function(){var n,e,r,i,u,a,s;if(n=We,(e=br())!==o)if(tr()!==o){for(r=[],i=We,44===t.charCodeAt(We)?(u=",",We++):(u=o,0===je&&He(Un)),u!==o&&(a=tr())!==o&&(s=br())!==o?i=u=[u,a,s]:(We=i,i=o);i!==o;)r.push(i),i=We,44===t.charCodeAt(We)?(u=",",We++):(u=o,0===je&&He(Un)),u!==o&&(a=tr())!==o&&(s=br())!==o?i=u=[u,a,s]:(We=i,i=o);r!==o?(n,e=Gn(e,r),n=e):(We=n,n=o)}else We=n,n=o;else We=n,n=o;return n}())!==o&&tr()!==o&&Nr()!==o?(n,n=r):(We=n,n=o)):(We=n,n=o);return n}())!==o&&(n,e=function(t){var n={};return n.colorArrows=t,n}(e)),(n=e)===o&&(n=We,(e=function(){var n,e,r,i,u;n=We,(e=Sr())!==o&&tr()!==o?(37===t.charCodeAt(We)?(r="%",We++):(r=o,0===je&&He(Fn)),r!==o&&(i=function(){var n,e;n=We,"clk"===t.substr(We,3)?(e="clk",We+=3):(e=o,0===je&&He(jn));e!==o&&(n,e="clk");(n=e)===o&&(n=We,"egt"===t.substr(We,3)?(e="egt",We+=3):(e=o,0===je&&He(qn)),e!==o&&(n,e="egt"),(n=e)===o&&(n=We,"emt"===t.substr(We,3)?(e="emt",We+=3):(e=o,0===je&&He(Qn)),e!==o&&(n,e="emt"),(n=e)===o&&(n=We,"mct"===t.substr(We,3)?(e="mct",We+=3):(e=o,0===je&&He(Kn)),e!==o&&(n,e="mct"),n=e)));return n}())!==o&&Or()!==o&&(u=function(){var n,e,r,i,u,a,s,l,c;n=We,(e=kr())!==o?((r=kr())===o&&(r=null),r!==o?(58===t.charCodeAt(We)?(i=":",We++):(i=o,0===je&&He(Vn)),i!==o&&(u=kr())!==o&&(a=kr())!==o?(58===t.charCodeAt(We)?(s=":",We++):(s=o,0===je&&He(Vn)),s!==o&&(l=kr())!==o&&(c=kr())!==o?(n,e=function(t,n,e,r,o,i){var u=t;return n&&(u+=n),u+=":"+e+r+":"+o+i}(e,r,u,a,l,c),n=e):(We=n,n=o)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o);return n}())!==o&&tr()!==o&&Nr()!==o?(n,e=function(t,n){var e={};return e.type=t,e.value=n,e}(i,u),n=e):(We=n,n=o)):(We=n,n=o);return n}())!==o&&(n,e=function(t){var n={};return n.clock=t,n}(e)),n=e)),n}function dr(){var t,n,e;return t=We,(n=Ar())!==o&&(e=Er())!==o?(t,t=n=n+e):(We=t,t=o),t}function br(){var t,n,e,r;return t=We,(n=Ar())!==o&&(e=Er())!==o&&(r=Er())!==o?(t,t=n=n+e+r):(We=t,t=o),t}function Ar(){var n,e;return n=We,89===t.charCodeAt(We)?(e="Y",We++):(e=o,0===je&&He(Bn)),e!==o&&(n,e="Y"),(n=e)===o&&(n=We,71===t.charCodeAt(We)?(e="G",We++):(e=o,0===je&&He(Rn)),e!==o&&(n,e="G"),(n=e)===o&&(n=We,82===t.charCodeAt(We)?(e="R",We++):(e=o,0===je&&He(Ln)),e!==o&&(n,e="R"),(n=e)===o&&(n=We,66===t.charCodeAt(We)?(e="B",We++):(e=o,0===je&&He(Dn)),e!==o&&(n,e="B"),n=e))),n}function Er(){var t,n,e;return t=We,(n=Ir())!==o&&(e=Wr())!==o?(t,t=n=n+e):(We=t,t=o),t}function yr(){var n;return 123===t.charCodeAt(We)?(n="{",We++):(n=o,0===je&&He(In)),n}function Cr(){var n;return 125===t.charCodeAt(We)?(n="}",We++):(n=o,0===je&&He(Wn)),n}function Sr(){var n;return 91===t.charCodeAt(We)?(n="[",We++):(n=o,0===je&&He($n)),n}function Nr(){var n;return 93===t.charCodeAt(We)?(n="]",We++):(n=o,0===je&&He(Mn)),n}function kr(){var n,e;return n=We,kn.test(t.charAt(We))?(e=t.charAt(We),We++):(e=o,0===je&&He(Tn)),e!==o&&(n,e=e),n=e}function Tr(){var n;return 40===t.charCodeAt(We)?(n="(",We++):(n=o,0===je&&He(Yn)),n}function wr(){var n;return 41===t.charCodeAt(We)?(n=")",We++):(n=o,0===je&&He(Hn)),n}function _r(){var t,n,e,r;if(t=We,(n=xr())!==o){for(e=[],r=Pr();r!==o;)e.push(r),r=Pr();e!==o?(t,t=n=n):(We=t,t=o)}else We=t,t=o;return t}function xr(){var n,e,r;if(je++,n=We,e=[],kn.test(t.charAt(We))?(r=t.charAt(We),We++):(r=o,0===je&&He(Tn)),r!==o)for(;r!==o;)e.push(r),kn.test(t.charAt(We))?(r=t.charAt(We),We++):(r=o,0===je&&He(Tn));else e=o;return e!==o&&(n,e=wn(e)),je--,(n=e)===o&&(e=o,0===je&&He(Zn)),n}function Or(){var n,e,r;if(n=We,e=[],32===t.charCodeAt(We)?(r=" ",We++):(r=o,0===je&&He(zn)),r!==o)for(;r!==o;)e.push(r),32===t.charCodeAt(We)?(r=" ",We++):(r=o,0===je&&He(zn));else e=o;return e!==o&&(n,e=""),n=e}function Pr(){var n;return(n=function(){var n;return 46===t.charCodeAt(We)?(n=".",We++):(n=o,0===je&&He(dn)),n}())===o&&(n=Or()),n}function Ur(){var n,e,r,i,u,a,s,l,c,f,v,p,h,g,m,d,b;return n=We,(e=Dr())===o&&(e=null),e!==o?(r=We,je++,i=function(){var t,n,e,r,i;t=We,(n=Lr())!==o?((e=$r())===o&&(e=null),e!==o&&(r=Ir())!==o&&(i=Wr())!==o?t=n=[n,e,r,i]:(We=t,t=o)):(We=t,t=o);return t}(),je--,i!==o?(We=r,r=void 0):r=o,r!==o&&(i=Lr())!==o?((u=$r())===o&&(u=null),u!==o&&(a=Ir())!==o&&(s=Wr())!==o?((l=Br())===o&&(l=null),l!==o?((c=Gr())===o&&(c=null),c!==o?(n,v=i,p=u,h=a,g=s,m=l,d=c,(b={}).fig=(f=e)||null,b.disc=v||null,b.strike=p||null,b.col=h,b.row=g,b.check=d||null,b.promotion=m,b.notation=(f||"")+(v||"")+(p||"")+h+g+(m||"")+(d||""),n=e=b):(We=n,n=o)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o),n===o&&(n=We,(e=Dr())===o&&(e=null),e!==o&&(r=Ir())!==o&&(i=Wr())!==o?((u=function(){var n;120===t.charCodeAt(We)?(n="x",We++):(n=o,0===je&&He(Ie));n===o&&(45===t.charCodeAt(We)?(n="-",We++):(n=o,0===je&&He(Nn)));return n}())===o&&(u=null),u!==o&&(a=Ir())!==o&&(s=Wr())!==o?((l=Br())===o&&(l=null),l!==o?((c=Gr())===o&&(c=null),c!==o?(n,n=e=function(t,n,e,r,o,i,u,a){var s={};return s.fig=t||null,s.strike="x"==r?r:null,s.col=o,s.row=i,s.check=a||null,s.notation=(t&&"P"!==t?t:"")+n+e+("x"==r?r:"-")+o+i+(u||"")+(a||""),s.promotion=u,s}(e,r,i,u,a,s,l,c)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o),n===o&&(n=We,(e=Dr())===o&&(e=null),e!==o?((r=$r())===o&&(r=null),r!==o&&(i=Ir())!==o&&(u=Wr())!==o?((a=Br())===o&&(a=null),a!==o?((s=Gr())===o&&(s=null),s!==o?(n,n=e=function(t,n,e,r,o,i){var u={};return u.fig=t||null,u.strike=n||null,u.col=e,u.row=r,u.check=i||null,u.notation=(t||"")+(n||"")+e+r+(o||"")+(i||""),u.promotion=o,u}(e,r,i,u,a,s)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o)):(We=n,n=o),n===o&&(n=We,"O-O-O"===t.substr(We,5)?(e="O-O-O",We+=5):(e=o,0===je&&He(Xn)),e!==o?((r=Gr())===o&&(r=null),r!==o?(n,n=e=function(t){var n={};return n.notation="O-O-O"+(t||""),n.check=t||null,n}(r)):(We=n,n=o)):(We=n,n=o),n===o&&(n=We,"O-O"===t.substr(We,3)?(e="O-O",We+=3):(e=o,0===je&&He(Jn)),e!==o?((r=Gr())===o&&(r=null),r!==o?(n,n=e=function(t){var n={};return n.notation="O-O"+(t||""),n.check=t||null,n}(r)):(We=n,n=o)):(We=n,n=o))))),n}function Gr(){var n,e,r,i;return n=We,e=We,r=We,je++,"+-"===t.substr(We,2)?(i="+-",We+=2):(i=o,0===je&&He(te)),je--,i===o?r=void 0:(We=r,r=o),r!==o?(43===t.charCodeAt(We)?(i="+",We++):(i=o,0===je&&He(ne)),i!==o?e=r=[r,i]:(We=e,e=o)):(We=e,e=o),e!==o&&(n,e=ee(e)),(n=e)===o&&(n=We,e=We,r=We,je++,"$$$"===t.substr(We,3)?(i="$$$",We+=3):(i=o,0===je&&He(re)),je--,i===o?r=void 0:(We=r,r=o),r!==o?(35===t.charCodeAt(We)?(i="#",We++):(i=o,0===je&&He(oe)),i!==o?e=r=[r,i]:(We=e,e=o)):(We=e,e=o),e!==o&&(n,e=ee(e)),n=e),n}function Br(){var n,e,r;return n=We,61===t.charCodeAt(We)?(e="=",We++):(e=o,0===je&&He(ie)),e!==o&&(r=function(){var n;Ue.test(t.charAt(We))?(n=t.charAt(We),We++):(n=o,0===je&&He(Ge));return n}())!==o?(n,n=e="="+r):(We=n,n=o),n}function Rr(){var n,e,r,i,u;return n=We,(e=function(){var n,e,r;n=We,36===t.charCodeAt(We)?(e="$",We++):(e=o,0===je&&He(ue));e!==o&&(r=xr())!==o?(n,n=e="$"+r):(We=n,n=o);n===o&&(n=We,"!!"===t.substr(We,2)?(e="!!",We+=2):(e=o,0===je&&He(ae)),e!==o&&(n,e="$3"),(n=e)===o&&(n=We,"??"===t.substr(We,2)?(e="??",We+=2):(e=o,0===je&&He(se)),e!==o&&(n,e="$4"),(n=e)===o&&(n=We,"!?"===t.substr(We,2)?(e="!?",We+=2):(e=o,0===je&&He(le)),e!==o&&(n,e="$5"),(n=e)===o&&(n=We,"?!"===t.substr(We,2)?(e="?!",We+=2):(e=o,0===je&&He(ce)),e!==o&&(n,e="$6"),(n=e)===o&&(n=We,33===t.charCodeAt(We)?(e="!",We++):(e=o,0===je&&He(fe)),e!==o&&(n,e="$1"),(n=e)===o&&(n=We,63===t.charCodeAt(We)?(e="?",We++):(e=o,0===je&&He(ve)),e!==o&&(n,e="$2"),(n=e)===o&&(n=We,8252===t.charCodeAt(We)?(e="‼",We++):(e=o,0===je&&He(pe)),e!==o&&(n,e="$3"),(n=e)===o&&(n=We,8263===t.charCodeAt(We)?(e="⁇",We++):(e=o,0===je&&He(he)),e!==o&&(n,e="$4"),(n=e)===o&&(n=We,8265===t.charCodeAt(We)?(e="⁉",We++):(e=o,0===je&&He(ge)),e!==o&&(n,e="$5"),(n=e)===o&&(n=We,8264===t.charCodeAt(We)?(e="⁈",We++):(e=o,0===je&&He(me)),e!==o&&(n,e="$6"),(n=e)===o&&(n=We,9633===t.charCodeAt(We)?(e="□",We++):(e=o,0===je&&He(de)),e!==o&&(n,e="$7"),(n=e)===o&&(n=We,61===t.charCodeAt(We)?(e="=",We++):(e=o,0===je&&He(ie)),e!==o&&(n,e="$10"),(n=e)===o&&(n=We,8734===t.charCodeAt(We)?(e="∞",We++):(e=o,0===je&&He(be)),e!==o&&(n,e="$13"),(n=e)===o&&(n=We,10866===t.charCodeAt(We)?(e="⩲",We++):(e=o,0===je&&He(Ae)),e!==o&&(n,e="$14"),(n=e)===o&&(n=We,10865===t.charCodeAt(We)?(e="⩱",We++):(e=o,0===je&&He(Ee)),e!==o&&(n,e="$15"),(n=e)===o&&(n=We,177===t.charCodeAt(We)?(e="±",We++):(e=o,0===je&&He(ye)),e!==o&&(n,e="$16"),(n=e)===o&&(n=We,8723===t.charCodeAt(We)?(e="∓",We++):(e=o,0===je&&He(Ce)),e!==o&&(n,e="$17"),(n=e)===o&&(n=We,"+-"===t.substr(We,2)?(e="+-",We+=2):(e=o,0===je&&He(te)),e!==o&&(n,e="$18"),(n=e)===o&&(n=We,"-+"===t.substr(We,2)?(e="-+",We+=2):(e=o,0===je&&He(Se)),e!==o&&(n,e="$19"),(n=e)===o&&(n=We,10752===t.charCodeAt(We)?(e="⨀",We++):(e=o,0===je&&He(Ne)),e!==o&&(n,e="$22"),(n=e)===o&&(n=We,10227===t.charCodeAt(We)?(e="⟳",We++):(e=o,0===je&&He(ke)),e!==o&&(n,e="$32"),(n=e)===o&&(n=We,8594===t.charCodeAt(We)?(e="→",We++):(e=o,0===je&&He(Te)),e!==o&&(n,e="$36"),(n=e)===o&&(n=We,8593===t.charCodeAt(We)?(e="↑",We++):(e=o,0===je&&He(we)),e!==o&&(n,e="$40"),(n=e)===o&&(n=We,8646===t.charCodeAt(We)?(e="⇆",We++):(e=o,0===je&&He(_e)),e!==o&&(n,e="$132"),(n=e)===o&&(n=We,68===t.charCodeAt(We)?(e="D",We++):(e=o,0===je&&He(xe)),e!==o&&(n,e="$220"),n=e)))))))))))))))))))))))));return n}())!==o&&tr()!==o?((r=Rr())===o&&(r=null),r!==o?(n,i=e,(u=r||[]).unshift(i),n=e=u):(We=n,n=o)):(We=n,n=o),n}function Lr(){var t;return(t=Ir())===o&&(t=Wr()),t}function Dr(){var n;return Oe.test(t.charAt(We))?(n=t.charAt(We),We++):(n=o,0===je&&He(Pe)),n}function Ir(){var n;return Be.test(t.charAt(We))?(n=t.charAt(We),We++):(n=o,0===je&&He(Re)),n}function Wr(){var n;return Le.test(t.charAt(We))?(n=t.charAt(We),We++):(n=o,0===je&&He(De)),n}function $r(){var n;return 120===t.charCodeAt(We)?(n="x",We++):(n=o,0===je&&He(Ie)),n}if((e=u())!==o&&We===t.length)return e;throw e!==o&&We<t.length&&He({type:"end"}),Ze(Fe,Me<t.length?t.charAt(Me):null,Me<t.length?Ye(Me,Me+1):Ye(Me,Me))}}}])}));
//# sourceMappingURL=pgn.js.map